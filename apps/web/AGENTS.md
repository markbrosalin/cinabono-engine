# AGENTS.md — правила работы агента в этом репозитории (FSD)

## Главное

Твоя задача — делать изменения так, чтобы они **соответствовали FSD** и **переиспользовали существующий код**. Не “нафигачить в один файл”, а встроиться в проект.

## Обязательный рабочий цикл (всегда)

1. **Варианты решения (до кода)**  
   Сначала предложи 2–3 варианта реализации (кратко), с:
    - куда в FSD это ляжет (слой/сегмент)
    - плюсы/минусы
    - риски (сложность, техдолг, затронутые зависимости)
    - рекомендация: какой вариант лучше и почему  
      ✅ Если варианты отличаются **архитектурно** (перенос по слоям, создание нового модуля/публичного API) — **остановись и попроси выбрать**.

2. **Проверка: “а это уже есть?” (до кода)** Перед созданием новых сущностей **обязательно проверь**, что в проекте уже существует:
    - в первую очередь: `shared/**`
    - затем: `entities/**`, `features/**`
    - затем: `widgets/**`, `pages/**` Ищи по: названию, смыслу, типам, похожему UI/хукам/утилитам.  
      Правило: **не создавай новый тип/константу/хелпер**, пока не убедился, что аналога нет.

3. **План изменений** Дай список файлов, которые тронешь/создашь, и что именно сделаешь в каждом (1–2 строки).

4. **Реализация**
    - Делай **минимальные диффы**.
    - **Не** складывай всё в один файл “для удобства”.
    - Переиспользуй существующие exports/imports, следуй текущим паттернам проекта.

5. **Проверка качества**
    - Запусти/предложи запуск линтера/типчека/тестов для затронутого пакета (если доступно).
    - Если тестов нет — укажи, как проверить вручную.

---

## Правила FSD (кратко)

Используй FSD-логику при выборе места для кода:

- `shared/` — переиспользуемые примитивы и инфраструктура:
    - `shared/ui` — базовые UI-компоненты без бизнес-смысла
    - `shared/lib` — утилиты, хелперы, хуки общего назначения
    - `shared/api` — базовые клиенты/инстансы/общие DTO (если так принято в проекте)
    - `shared/config` — конфиг/флаги/константы, которые реально “shared”
    - `shared/assets` — ассеты

- `entities/` — доменные сущности (данные + модель + UI сущности):
    - модели, типы домена, entity-ui, селекторы

- `features/` — пользовательские действия/сценарии (одна “фича”):
    - формы, кнопки действия, хендлеры, флоу в рамках одного действия

- `widgets/` — композиция нескольких features/entities в блок интерфейса

- `pages/` — страница/роут, композиция виджетов

- `app/` — инициализация приложения, провайдеры, роутинг, глобальная конфигурация

### Золотое правило

Если ты понимаешь, что запрошенная пользователем вещь **лучше лежит в другом слое** —  
**предложи перенос** (с аргументами) и **обсуди**, а не делай молча.

---

## Переиспользование и недопущение дублей

Перед созданием новых:

- `types`, `enums`, `constants`, `tokens`, `api`-клиентов, `hooks`, `ui`-компонентов  
  сделай поиск и приоритизируй **реюз**.

Если похожее уже есть, но “не идеально”:

- предложи: (а) адаптировать существующее, (б) сделать обёртку, (в) аккуратно расширить API
- объясни компромиссы

---

## Когда нельзя “слепо выполнить просьбу”

Остановись и вынеси на обсуждение, если:

- просьба ломает FSD (например, бизнес-логика в `shared/ui`)
- требуется вынести/переименовать публичные exports
- нужно создать “новый общий модуль” в `shared` (это влияет на весь проект)
- появляются сомнения, что “так вообще стоит делать” (техдолг/сложность/дубли)

---

## Формат ответа (коротко)

Всегда придерживайся структуры:

1. Варианты (2–3) + рекомендация
2. Что уже есть в проекте (результат проверки)
3. План файлов
4. Изменения (диффы)
5. Проверка (команды/шаги)
